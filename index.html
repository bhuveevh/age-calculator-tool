<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detailed Age Calculator</title>
    <style>
        /* पुराना सुंदर UI */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 15px; /* थोड़ी पैडिंग वापस दी ताकि UI बहुत चिपका हुआ न लगे */
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            box-sizing: border-box;
            line-height: 1.6; /* पढ़ने में आसानी के लिए */
            color: #333;
        }
        .calculator-container {
            border: 1px solid #ddd;
            padding: 25px; /* पैडिंग बढ़ाई */
            border-radius: 10px; /* थोड़ा और गोल */
            max-width: 600px;
            width: 100%;
            background-color: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* गहरा शैडो */
            margin: 0;
        }
        h3 {
            color: #2c3e50; /* गहरा नीला/ग्रे */
            margin-top: 0;
            text-align: center;
            font-size: 2em; /* बड़ा फ़ॉन्ट साइज़ */
            margin-bottom: 30px; /* ज़्यादा स्पेस */
            font-weight: 600; /* थोड़ा मोटा */
        }
        .input-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 25px; /* ज़्यादा स्पेस */
        }
        .input-field {
            flex: 1 1 48%;
            min-width: 280px;
            margin-bottom: 20px; /* ज़्यादा स्पेस */
        }
        label {
            display: block;
            margin-bottom: 10px; /* ज़्यादा स्पेस */
            font-weight: bold;
            color: #555;
            font-size: 1.15em; /* थोड़ा बड़ा */
        }
        input[type="date"] {
            width: calc(100% - 22px); /* पैडिंग के लिए एडजस्टमेंट */
            padding: 12px; /* ज़्यादा पैडिंग */
            border: 1px solid #c0c0c0; /* हल्का बॉर्डर */
            border-radius: 6px; /* गोल */
            font-size: 1.05em;
            box-sizing: border-box;
            transition: border-color 0.3s ease; /* ट्रांज़िशन */
        }
        input[type="date"]:focus {
            border-color: #007bff; /* फोकस पर नीला बॉर्डर */
            outline: none;
        }
        button {
            color: white;
            padding: 14px 30px; /* ज़्यादा पैडिंग */
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.2em; /* बड़ा फ़ॉन्ट साइज़ */
            font-weight: 600; /* मोटा फ़ॉन्ट */
            width: 100%;
            transition: background-color 0.3s ease, transform 0.2s ease; /* ट्रांज़िशन */
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* बटन पर शैडो */
        }
        button:hover {
            opacity: 0.95;
            transform: translateY(-2px); /* होवर पर थोड़ा ऊपर */
        }
        button:active {
            transform: translateY(0); /* क्लिक पर वापस */
        }
        .calculate-btn {
            background-color: #28a745; /* हरा */
        }
        #detailed_error_revised {
            color: #dc3545; /* लाल */
            margin-top: 15px;
            text-align: center;
            font-size: 1em;
            font-weight: bold;
        }
        #detailed_result_revised {
            margin-top: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px; /* ज़्यादा स्पेस */
            font-size: 0.98em;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); /* टेबल पर हल्का शैडो */
            border-radius: 8px; /* टेबल को गोल */
            overflow: hidden; /* गोल किनारों के लिए */
        }
        table th, table td {
            padding: 12px; /* ज़्यादा पैडिंग */
            border: 1px solid #e0e0e0; /* हल्का बॉर्डर */
            text-align: left;
        }
        table th {
            background-color: #e3f2fd; /* मटेरियल ब्लू का हल्का शेड */
            font-size: 1.15em;
            color: #1a237e; /* मटेरियल ब्लू का गहरा शेड */
            font-weight: 700; /* ज़्यादा मोटा */
        }
        table td {
            background-color: #ffffff; /* सफ़ेद बैकग्राउंड */
            color: #333;
        }
        table tbody tr:nth-child(even) td {
            background-color: #f8f8f8; /* अल्टरनेट रोज़ के लिए हल्का ग्रे */
        }
        table tbody tr:hover td {
            background-color: #f0f8ff; /* होवर पर हल्का नीला */
        }
        /* Responsive adjustments */
        @media (max-width: 600px) {
            .input-field {
                flex: 1 1 100%;
                min-width: unset;
            }
            .calculator-container {
                padding: 15px;
            }
            h3 {
                font-size: 1.7em;
            }
            button {
                font-size: 1.1em;
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container" id="age_calculator_section">
        <h3>Detailed Age Calculator</h3>

        <div class="input-group">
            <div class="input-field">
                <label for="dob_date_revised">Date of Birth:</label>
                <input type="date" id="dob_date_revised">
            </div>
            <div class="input-field">
                <label for="find_age_on_date_revised">Find Age on:</label>
                <input type="date" id="find_age_on_date_revised">
            </div>
        </div>

        <button onclick="calculateDetailedAgeRevised()" class="calculate-btn">Calculate Age</button>

        <div id="detailed_error_revised"></div>

        <div id="detailed_result_revised">
            </div>

        </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const todayString = `${year}-${month}-${day}`;

            const findAgeOnInput = document.getElementById('find_age_on_date_revised');
            if (findAgeOnInput) {
                findAgeOnInput.value = todayString;
            }

            // linkDobInput अब मौजूद नहीं है, इसलिए इसे हटा दिया गया है
            // const linkDobInput = document.getElementById('link_dob_date_revised');
            // if (linkDobInput) {
            //     linkDobInput.value = todayString;
            // }

            const initialDob = getUrlParameterRevised('dob_revised');
            const dobDateInput = document.getElementById('dob_date_revised');
            if (initialDob && dobDateInput) {
                dobDateInput.value = initialDob;
                calculateDetailedAgeRevised();
            }

            sendIframeHeight();
        });

        // Main calculation function
        function calculateDetailedAgeRevised() {
            const dobInput = document.getElementById('dob_date_revised');
            const findAgeOnInput = document.getElementById('find_age_on_date_revised');
            const resultDiv = document.getElementById('detailed_result_revised');
            const errorDiv = document.getElementById('detailed_error_revised');

            resultDiv.innerHTML = '';
            errorDiv.textContent = '';

            const dobValue = dobInput ? dobInput.value : '';
            const targetDateValue = findAgeOnInput ? findAgeOnInput.value : '';

            if (!dobValue) {
                errorDiv.textContent = 'Please enter a valid Date of Birth.';
                sendIframeHeight();
                return;
            }
            if (!targetDateValue) {
                errorDiv.textContent = 'Please enter a valid "Find Age on" date.';
                sendIframeHeight();
                return;
            }

            const dob = new Date(dobValue);
            const targetDate = new Date(targetDateValue);

            dob.setHours(0, 0, 0, 0);
            targetDate.setHours(0, 0, 0, 0);

            if (dob > targetDate) {
                errorDiv.textContent = 'Date of Birth cannot be after the "Find Age on" date.';
                sendIframeHeight();
                return;
            }

            let years = targetDate.getFullYear() - dob.getFullYear();
            let months = targetDate.getMonth() - dob.getMonth();
            let days = targetDate.getDate() - dob.getDate();

            if (days < 0) {
                months--;
                const prevMonthDate = new Date(targetDate.getFullYear(), targetDate.getMonth(), 0);
                days += prevMonthDate.getDate();
            }

            if (months < 0) {
                years--;
                months += 12;
            }

            const totalMilliseconds = targetDate.getTime() - dob.getTime();
            const msInDay = 1000 * 60 * 60 * 24;

            const totalDays = Math.floor(totalMilliseconds / msInDay);
            const totalWeeks = Math.floor(totalDays / 7);
            const remainingDaysAfterWeeks = totalDays % 7;

            const totalMonthsApprox = Math.floor(totalDays / 30.436875);
            const decimalYears = (totalDays / 365.25).toFixed(4);

            const totalHoursApprox = Math.floor(totalMilliseconds / (1000 * 60 * 60));
            const totalMinutesApprox = Math.floor(totalMilliseconds / (1000 * 60));
            const totalSecondsApprox = Math.floor(totalMilliseconds / 1000);

            let nextBirthdayThisYear = new Date(targetDate.getFullYear(), dob.getMonth(), dob.getDate());
            let daysUntilNextBirthday;
            let nextBirthdayDateFormatted;

            if (nextBirthdayThisYear < targetDate) {
                nextBirthdayThisYear.setFullYear(targetDate.getFullYear() + 1);
            }
            const diffMs = nextBirthdayThisYear.getTime() - targetDate.getTime();
            daysUntilNextBirthday = Math.ceil(diffMs / msInDay);
            nextBirthdayDateFormatted = nextBirthdayThisYear.toLocaleDateString('en-US', { day: 'numeric', month: 'long' });

            let ageLastBirthday = targetDate.getFullYear() - dob.getFullYear();
            if (targetDate.getMonth() < dob.getMonth() || (targetDate.getMonth() === dob.getMonth() && targetDate.getDate() < dob.getDate())) {
                ageLastBirthday--;
            }
            let ageNextBirthday = ageLastBirthday + 1;

            let ageNearestBirthday = ageLastBirthday;
            if (daysUntilNextBirthday <= (365.25 / 2) || daysUntilNextBirthday === 0) {
                ageNearestBirthday = ageNextBirthday;
            }

            let html = `
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 25px; font-size: 0.98em; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;">
                    <thead>
                        <tr>
                            <th colspan="2" style="background-color: #e3f2fd; padding: 12px; border: 1px solid #e0e0e0; text-align: left; font-size: 1.15em; color: #1a237e; font-weight: 700;">Answer:</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; font-weight: bold; width: 40%; background-color: #ffffff;">Age =</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; color: #007bff; font-weight: bold; background-color: #ffffff;">${years} years, ${months} months, ${days} days</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0; font-weight: bold;">Born on:</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${dob.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; font-weight: bold; background-color: #ffffff;">Age on:</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${targetDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</td>
                        </tr>
                    </tbody>
                </table>

                <table style="width: 100%; border-collapse: collapse; margin-bottom: 25px; font-size: 0.98em; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;">
                    <thead>
                        <tr>
                            <th colspan="2" style="background-color: #e3f2fd; padding: 12px; border: 1px solid #e0e0e0; text-align: left; font-size: 1.15em; color: #1a237e; font-weight: 700;">Age in different time units:</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; width: 40%; background-color: #ffffff;">= decimal years</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${decimalYears}</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">= years and months and days</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${years} years, ${months} months, ${days} days</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">= months and days</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${totalMonthsApprox} months, ${Math.floor(totalDays - (totalMonthsApprox * 30.436875))} days</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">= weeks and days</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${totalWeeks} weeks, ${remainingDaysAfterWeeks} days</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">= days</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${totalDays} days</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">≈ hours*</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${totalHoursApprox.toLocaleString()} hours</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">≈ minutes*</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${totalMinutesApprox.toLocaleString()} minutes</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">≈ seconds*</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${totalSecondsApprox.toLocaleString()} seconds</td>
                        </tr>
                        <tr>
                            <td colspan="2" style="padding: 12px; border: 1px solid #e0e0e0; font-size: 0.9em; color: #666; background-color: #ffffff;">* These are approximations. Find exact age in Years, Days, Hours, Minutes and Seconds (requires exact birth time)</td>
                        </tr>
                    </tbody>
                </table>

                <table style="width: 100%; border-collapse: collapse; margin-bottom: 25px; font-size: 0.98em; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;">
                    <thead>
                        <tr>
                            <th colspan="2" style="background-color: #e3f2fd; padding: 12px; border: 1px solid #e0e0e0; text-align: left; font-size: 1.15em; color: #1a237e; font-weight: 700;">Birthday/Anniversary Details:</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; width: 40%; background-color: #ffffff;">Days until next birthday:</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${daysUntilNextBirthday} days (${nextBirthdayDateFormatted})</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">Age Last Birthday:</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${ageLastBirthday} years</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">Age Next Birthday:</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0; background-color: #ffffff;">${ageNextBirthday} years</td>
                        </tr>
                        <tr style="background-color: #f8f8f8;">
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">Age Nearest Birthday:</td>
                            <td style="padding: 12px; border: 1px solid #e0e0e0;">${ageNearestBirthday} years</td>
                        </tr>
                    </tbody>
                </table>
            `;
            resultDiv.innerHTML = html;
            sendIframeHeight();
        }

        // "Generate Link" फंक्शन हटा दिया गया है
        // function generateAgeLinkRevised() { ... }

        // Helper function to get URL parameters
        function getUrlParameterRevised(name) {
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(window.location.href);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        // --- PostMessage API के लिए कोड ---
        function sendIframeHeight() {
            const body = document.body;
            const contentHeight = body.scrollHeight; 
            
            // अपनी वास्तविक WordPress वेबसाइट के डोमेन से बदलें
            const targetOrigin = 'YOUR_WORDPRESS_SITE_DOMAIN_HERE'; 

            if (window.parent) { 
                window.parent.postMessage({
                    frameHeight: contentHeight + 10 // कुछ अतिरिक्त पैडिंग/सुरक्षा मार्जिन
                }, targetOrigin);
            }
        }

        const resizeObserver = new ResizeObserver(() => {
            sendIframeHeight();
        });

        const calculatorContainer = document.getElementById('age_calculator_section');
        if (calculatorContainer) {
            resizeObserver.observe(calculatorContainer);
        }

        // सुनिश्चित करें कि ऊंचाई विभिन्न इवेंट्स पर भेजी जाए
        window.addEventListener('load', sendIframeHeight);
        window.addEventListener('resize', sendIframeHeight);
        // छोटे टाइमआउट के बाद भी भेजें
        setTimeout(sendIframeHeight, 500); 
        setTimeout(sendIframeHeight, 2000); 

    </script>
</body>
</html>
